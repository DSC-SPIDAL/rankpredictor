============ 12 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
testcar: 12
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5170068027210885, mae=5.142857142857143,5.142857142857143, rmse=51.91836734693877,r2=-0.7758782801948885, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.527027027027027, mae=5.135135135135135,5.135135135135135, rmse=52.7027027027027,r2=-0.8430678202338318, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.202702702702703,5.202702702702703, rmse=53.648648648648646,r2=-1.0067933692071498, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.175675675675675,5.175675675675675, rmse=51.986486486486484,r2=-1.1041008006474655, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.162162162162162,5.162162162162162, rmse=52.25675675675676,r2=-0.8408037168850344, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.121621621621622,5.121621621621622, rmse=50.945945945945944,r2=-0.7168977311016163, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.216216216216216,5.216216216216216, rmse=52.554054054054056,r2=-0.9151420371833796, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.195945945945946,5.195945945945946, rmse=51.03378378378378,r2=-0.9637205576479848, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.466216216216216,5.466216216216216, rmse=59.38513513513514,r2=-0.804622641509434, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.216216216216216,5.216216216216216, rmse=52.0945945945946,r2=-0.8582821296602399, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.243243243243243,5.243243243243243, rmse=54.2027027027027,r2=-0.9308146541139275, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.966216216216216,4.966216216216216, rmse=49.601351351351354,r2=-0.8717620061607159, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.222972972972973,5.222972972972973, rmse=52.42567567567568,r2=-0.8979439375909031, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.0,5.0, rmse=49.7972972972973,r2=-0.927372771592297, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.094594594594595,5.094594594594595, rmse=49.729729729729726,r2=-0.8163778829045902, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.087837837837838,5.087837837837838, rmse=50.70945945945946,r2=-1.02036480577403, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.074324324324325,5.074324324324325, rmse=50.46621621621622,r2=-0.7738245771687156, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.101351351351352,5.101351351351352, rmse=50.96621621621622,r2=-0.8791349371469355, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.0608108108108105,5.0608108108108105, rmse=50.25,r2=-0.987052375416122, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.081081081081081,5.081081081081081, rmse=51.432432432432435,r2=-0.9678492762331634, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.054054054054054,5.054054054054054, rmse=49.310810810810814,r2=-0.7212840179824986, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.081081081081081,5.081081081081081, rmse=50.13513513513514,r2=-0.8803755408716616, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.831081081081081,4.831081081081081, rmse=48.42567567567568,r2=-0.8227866373384656, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.0608108108108105,5.0608108108108105, rmse=49.398648648648646,r2=-0.757486177615208, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.162162162162162,5.162162162162162, rmse=52.74324324324324,r2=-0.8800241494401204, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.087837837837838,5.087837837837838, rmse=51.601351351351354,r2=-0.9900626804704555, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.97972972972973,4.97972972972973, rmse=50.46621621621622,r2=-0.8287595539820667, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.027027027027027,5.027027027027027, rmse=50.66216216216216,r2=-0.8808701768659053, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.0675675675675675,5.0675675675675675, rmse=51.21621621621622,r2=-0.832607754571963, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.0675675675675675,5.0675675675675675, rmse=51.013513513513516,r2=-0.8090419719107949, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4864864864864865, mae=5.135135135135135,5.135135135135135, rmse=51.67567567567568,r2=-1.0125349600925988, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.054054054054054,5.054054054054054, rmse=50.4054054054054,r2=-0.6979080643251383, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.108108108108108,5.108108108108108, rmse=50.527027027027025,r2=-1.0229614451709135, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.148648648648648,5.148648648648648, rmse=52.229729729729726,r2=-1.099390941004406, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.013513513513513,5.013513513513513, rmse=51.432432432432435,r2=-0.9380585627508424, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.945945945945946,4.945945945945946, rmse=49.71621621621622,r2=-0.8543252047194889, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4797297297297297, mae=5.371621621621622,5.371621621621622, rmse=54.939189189189186,r2=-0.9670659465679801, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.013513513513513,5.013513513513513, rmse=48.62162162162162,r2=-0.9520120235705976, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.195945945945946,5.195945945945946, rmse=51.11486486486486,r2=-0.918195461928029, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.013513513513513,5.013513513513513, rmse=52.7972972972973,r2=-0.9305067515119749, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.236486486486487,5.236486486486487, rmse=54.263513513513516,r2=-1.0753532291746692, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.141891891891892,5.141891891891892, rmse=49.62837837837838,r2=-0.7145948606002481, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.20945945945946,5.20945945945946, rmse=52.804054054054056,r2=-0.7404402337801479, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.054054054054054,5.054054054054054, rmse=51.21621621621622,r2=-0.9098302187765468, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.135135135135135,5.135135135135135, rmse=52.972972972972975,r2=-0.8470933018352811, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.101351351351352,5.101351351351352, rmse=49.939189189189186,r2=-0.8323729245118667, acc_naive=0.13513513513513514, mae_naive=4.614864864864865/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU

pred: acc=0.5337837837837838, mae=5.0608108108108105,5.0608108108108105, rmse=51.29054054054054,r2=-1.0247920181092032, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.135135135135135,5.135135135135135, rmse=50.33783783783784,r2=-0.8266731388261646, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.141891891891892,5.141891891891892, rmse=51.358108108108105,r2=-1.036842295853703, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.148648648648648,5.148648648648648, rmse=51.33783783783784,r2=-0.8397726510465156, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.5275023   5.11501931 51.43377275 -0.89091658]
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5238095238095238, mae=5.238095238095238,5.238095238095238, rmse=52.775510204081634,r2=-0.885375611691575, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5202702702702703, mae=5.1891891891891895,5.1891891891891895, rmse=49.58108108108108,r2=-0.9239268498785616, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.0675675675675675,5.0675675675675675, rmse=50.7972972972973,r2=-0.8995122600778813, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.101351351351352,5.101351351351352, rmse=51.263513513513516,r2=-0.9044837481936785, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.04054054054054,5.04054054054054, rmse=50.41891891891892,r2=-0.9202164376463793, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.952702702702703,4.952702702702703, rmse=50.66891891891892,r2=-0.9111522857674212, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.087837837837838,5.087837837837838, rmse=50.16891891891892,r2=-0.9756571140915464, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5302013422818792, mae=5.208053691275167,5.208053691275167, rmse=52.25503355704698,r2=-0.9329176857917854, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5337837837837838, mae=5.054054054054054,5.054054054054054, rmse=50.229729729729726,r2=-1.0521700852963178, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.081081081081081,5.081081081081081, rmse=51.391891891891895,r2=-0.814961296428566, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.912162162162162,4.912162162162162, rmse=47.601351351351354,r2=-0.7767485294017411, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5945945945945946, mae=4.858108108108108,4.858108108108108, rmse=47.277027027027025,r2=-0.5859118001997028, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.162162162162162,5.162162162162162, rmse=50.82432432432432,r2=-0.929002018661792, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.128378378378378,5.128378378378378, rmse=51.57432432432432,r2=-1.0663842427967283, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.175675675675675,5.175675675675675, rmse=52.2972972972973,r2=-0.8466032282348843, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5771812080536913, mae=4.919463087248322,4.919463087248322, rmse=48.946308724832214,r2=-0.8816962430388162, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5472972972972973, mae=4.993243243243243,4.993243243243243, rmse=49.439189189189186,r2=-0.9251155514470597, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.97972972972973,4.97972972972973, rmse=50.37162162162162,r2=-0.7692164609898144, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.162162162162162,5.162162162162162, rmse=50.2972972972973,r2=-0.7713465270442132, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.222972972972973,5.222972972972973, rmse=53.70945945945946,r2=-0.7987022517949536, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.033783783783784,5.033783783783784, rmse=49.479729729729726,r2=-0.7264073401510083, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.304054054054054,5.304054054054054, rmse=53.722972972972975,r2=-0.8971972862817932, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.22972972972973,5.22972972972973, rmse=54.0,r2=-1.0907745907507276, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.1891891891891895,5.1891891891891895, rmse=51.67567567567568,r2=-1.102992187427425, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.222972972972973,5.222972972972973, rmse=51.58783783783784,r2=-0.9523345496765634, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.013513513513513,5.013513513513513, rmse=50.62162162162162,r2=-0.9618013350955321, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.027027027027027,5.027027027027027, rmse=49.82432432432432,r2=-1.0027048899051088, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.02027027027027,5.02027027027027, rmse=49.979729729729726,r2=-0.932886522218142, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.101351351351352,5.101351351351352, rmse=51.91216216216216,r2=-0.8381214719404082, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.0608108108108105,5.0608108108108105, rmse=50.75,r2=-0.925857397282108, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.256756756756757,5.256756756756757, rmse=52.95945945945946,r2=-1.0365196599082531, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.175675675675675,5.175675675675675, rmse=51.71621621621622,r2=-1.0988395899378012, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.141891891891892,5.141891891891892, rmse=53.0472972972973,r2=-0.9671228609544193, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.216216216216216,5.216216216216216, rmse=51.83783783783784,r2=-0.8152338473098173, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.1824324324324325,5.1824324324324325, rmse=51.817567567567565,r2=-0.9163824484861582, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.175675675675675,5.175675675675675, rmse=53.2972972972973,r2=-0.9755673674252998, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.02027027027027,5.02027027027027, rmse=49.060810810810814,r2=-0.8423878754628995, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.155405405405405,5.155405405405405, rmse=52.38513513513514,r2=-0.8574148056539392, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5503355704697986, mae=4.919463087248322,4.919463087248322, rmse=47.375838926174495,r2=-0.7512862523352348, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5202702702702703, mae=5.054054054054054,5.054054054054054, rmse=51.78378378378378,r2=-0.7725797352394672, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.202702702702703,5.202702702702703, rmse=53.027027027027025,r2=-0.8319241051361514, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.243243243243243,5.243243243243243, rmse=53.229729729729726,r2=-0.8384861247550013, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.081081081081081,5.081081081081081, rmse=52.17567567567568,r2=-0.9911944316192034, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.155405405405405,5.155405405405405, rmse=51.12837837837838,r2=-0.9018891251333119, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.047297297297297,5.047297297297297, rmse=49.92567567567568,r2=-0.8588552857026301, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5167785234899329, mae=5.12751677852349,5.12751677852349, rmse=50.52348993288591,r2=-0.9082415226844325, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5337837837837838, mae=5.114864864864865,5.114864864864865, rmse=50.37162162162162,r2=-0.9865682391069501, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.04054054054054,5.04054054054054, rmse=51.148648648648646,r2=-0.861944608327863, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.128378378378378,5.128378378378378, rmse=49.99324324324324,r2=-0.8687659562848993, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.141891891891892,5.141891891891892, rmse=51.53378378378378,r2=-0.9204004137518034, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53545261  5.10635995 51.07563174 -0.90007564]
pred: acc=0.55, mae=1.94,1.94, rmse=8.42,r2=-17.72775800711744, acc_naive=0.5, mae_naive=1.75
pred: acc=0.61, mae=2.015,2.015, rmse=7.715,r2=-6.223951871532573, acc_naive=0.5, mae_naive=1.75
Traceback (most recent call last):
  File "stint-test-strategy.py", line 117, in <module>
    print(len(df12_low))
NameError: name 'df12_low' is not defined

If you suspect this is an IPython 7.13.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

====================================
============ 12 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
testcar: 12
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5306122448979592, mae=5.1020408163265305,5.1020408163265305, rmse=50.46258503401361,r2=-0.8033737410488364, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5405405405405406, mae=5.033783783783784,5.033783783783784, rmse=50.75,r2=-0.84022434411792, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.148648648648648,5.148648648648648, rmse=52.32432432432432,r2=-0.830958059821427, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.141891891891892,5.141891891891892, rmse=52.236486486486484,r2=-0.923949232228253, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.162162162162162,5.162162162162162, rmse=53.972972972972975,r2=-1.0889010610384218, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.135135135135135,5.135135135135135, rmse=53.648648648648646,r2=-0.8644086620307125, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.891891891891892,4.891891891891892, rmse=47.82432432432432,r2=-0.8220850038701377, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.391891891891892,5.391891891891892, rmse=54.945945945945944,r2=-0.9392259763110535, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.29054054054054,5.29054054054054, rmse=54.96621621621622,r2=-0.8948140407423264, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.0,5.0, rmse=50.5,r2=-0.8249388333545062, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.216216216216216,5.216216216216216, rmse=51.33783783783784,r2=-0.9963960253307933, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.1824324324324325,5.1824324324324325, rmse=52.53378378378378,r2=-0.8756193928645941, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.013513513513513,5.013513513513513, rmse=51.2972972972973,r2=-0.9510101317034632, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.081081081081081,5.081081081081081, rmse=51.5,r2=-0.8734146102478, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.148648648648648,5.148648648648648, rmse=52.229729729729726,r2=-1.124182339081175, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.006756756756757,5.006756756756757, rmse=50.101351351351354,r2=-0.8954891841288921, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.054054054054054,5.054054054054054, rmse=49.810810810810814,r2=-0.9260987997366092, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.162162162162162,5.162162162162162, rmse=52.729729729729726,r2=-0.9383906379279383, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.087837837837838,5.087837837837838, rmse=48.46621621621622,r2=-0.84727017094493, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.743243243243243,4.743243243243243, rmse=47.63513513513514,r2=-0.9727177334732424, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.97972972972973,4.97972972972973, rmse=49.49324324324324,r2=-0.8176300558651723, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.114864864864865,5.114864864864865, rmse=52.38513513513514,r2=-0.8619237085164244, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.29054054054054,5.29054054054054, rmse=53.722972972972975,r2=-0.960514741163299, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.087837837837838,5.087837837837838, rmse=51.4527027027027,r2=-1.1227520323059421, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.25,5.25, rmse=54.479729729729726,r2=-1.0485404893188948, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.135135135135135,5.135135135135135, rmse=50.054054054054056,r2=-1.105438617042319, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.195945945945946,5.195945945945946, rmse=51.87162162162162,r2=-0.7861009979060947, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.168918918918919,5.168918918918919, rmse=54.141891891891895,r2=-0.9115104156592715, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.101351351351352,5.101351351351352, rmse=52.00675675675676,r2=-0.8630342201840864, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.216216216216216,5.216216216216216, rmse=52.986486486486484,r2=-0.8874904659139145, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.858108108108108,4.858108108108108, rmse=48.763513513513516,r2=-0.7378930172924354, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.114864864864865,5.114864864864865, rmse=50.42567567567568,r2=-0.7637053454519906, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.3175675675675675,5.3175675675675675, rmse=55.736486486486484,r2=-0.9795887923206643, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.148648648648648,5.148648648648648, rmse=51.24324324324324,r2=-0.9000472289792953, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=4.993243243243243,4.993243243243243, rmse=51.0472972972973,r2=-1.0497976124131059, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.04054054054054,5.04054054054054, rmse=48.851351351351354,r2=-0.797773196707678, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.148648648648648,5.148648648648648, rmse=51.95945945945946,r2=-0.932124722647105, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.195945945945946,5.195945945945946, rmse=52.682432432432435,r2=-0.8663125820788344, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.087837837837838,5.087837837837838, rmse=50.398648648648646,r2=-0.8466083209549427, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.135135135135135,5.135135135135135, rmse=50.7027027027027,r2=-0.8255416585163793, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.1891891891891895,5.1891891891891895, rmse=51.75675675675676,r2=-0.8109354508409488, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.162162162162162,5.162162162162162, rmse=52.75675675675676,r2=-1.0529445310015615, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.0608108108108105,5.0608108108108105, rmse=49.804054054054056,r2=-1.0410794871986768, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.033783783783784,5.033783783783784, rmse=50.898648648648646,r2=-0.9998780216547438, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.02027027027027,5.02027027027027, rmse=50.87162162162162,r2=-0.9623621071021007, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.952702702702703,4.952702702702703, rmse=49.49324324324324,r2=-0.9186388123942546, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.175675675675675,5.175675675675675, rmse=53.33783783783784,r2=-1.0124885665020473, acc_naive=0.13513513513513514, mae_naive=4.614864864864865/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU

pred: acc=0.5472972972972973, mae=5.108108108108108,5.108108108108108, rmse=50.83783783783784,r2=-0.9797359882661452, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.101351351351352,5.101351351351352, rmse=49.939189189189186,r2=-0.9289755092827718, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=5.074324324324325,5.074324324324325, rmse=51.236486486486484,r2=-0.9937254400363824, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53750414  5.10906784 51.49222467 -0.9199712 ]
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5578231292517006, mae=4.98639455782313,4.98639455782313, rmse=49.01360544217687,r2=-0.7898836301446257, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.527027027027027, mae=5.168918918918919,5.168918918918919, rmse=51.91216216216216,r2=-0.8337343490965856, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.006756756756757,5.006756756756757, rmse=50.38513513513514,r2=-0.900474586544886, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.148648648648648,5.148648648648648, rmse=51.945945945945944,r2=-0.8438751351114842, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5878378378378378, mae=4.912162162162162,4.912162162162162, rmse=49.50675675675676,r2=-0.9450909769257265, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.27027027027027,5.27027027027027, rmse=56.0945945945946,r2=-1.015329478820683, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.20945945945946,5.20945945945946, rmse=51.939189189189186,r2=-0.9679434842173724, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.1824324324324325,5.1824324324324325, rmse=52.25,r2=-0.8736109383083079, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.128378378378378,5.128378378378378, rmse=51.11486486486486,r2=-0.9513870007459615, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.047297297297297,5.047297297297297, rmse=49.804054054054056,r2=-0.8433478425435277, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.168918918918919,5.168918918918919, rmse=51.62837837837838,r2=-0.8152557064432242, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.216216216216216,5.216216216216216, rmse=52.04054054054054,r2=-1.0193628506084331, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.02027027027027,5.02027027027027, rmse=49.182432432432435,r2=-0.8256339689404364, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=4.972972972972973,4.972972972972973, rmse=50.608108108108105,r2=-1.0733215002459513, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.155405405405405,5.155405405405405, rmse=50.682432432432435,r2=-0.7584218762869617, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.0675675675675675,5.0675675675675675, rmse=51.229729729729726,r2=-0.7758828882294762, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.202702702702703,5.202702702702703, rmse=51.554054054054056,r2=-1.0354771900162048, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.0675675675675675,5.0675675675675675, rmse=50.689189189189186,r2=-0.7766470007472726, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5878378378378378, mae=5.101351351351352,5.101351351351352, rmse=52.58783783783784,r2=-0.8723975604364163, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.195945945945946,5.195945945945946, rmse=51.060810810810814,r2=-0.9951265109243219, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5570469798657718, mae=4.946308724832215,4.946308724832215, rmse=49.48322147651007,r2=-0.8058958325114081, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5405405405405406, mae=5.121621621621622,5.121621621621622, rmse=50.45945945945946,r2=-0.9197576646037822, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.1824324324324325,5.1824324324324325, rmse=52.91216216216216,r2=-0.9548309618744986, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.236486486486487,5.236486486486487, rmse=51.49324324324324,r2=-1.0381423924828335, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5436241610738255, mae=5.10738255033557,5.10738255033557, rmse=51.04026845637584,r2=-0.9340641897427493, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5540540540540541, mae=4.993243243243243,4.993243243243243, rmse=49.70945945945946,r2=-0.7376114696438716, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.054054054054054,5.054054054054054, rmse=49.91891891891892,r2=-0.7250924925256572, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.0,5.0, rmse=48.527027027027025,r2=-0.917843514032856, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.121621621621622,5.121621621621622, rmse=51.189189189189186,r2=-0.8740846845431407, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.581081081081081, mae=4.945945945945946,4.945945945945946, rmse=49.013513513513516,r2=-0.8328595793064242, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=4.993243243243243,4.993243243243243, rmse=50.020270270270274,r2=-0.8127916134454891, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.081081081081081,5.081081081081081, rmse=49.87837837837838,r2=-0.9712504623490037, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.304054054054054,5.304054054054054, rmse=55.75,r2=-0.9626167623480404, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.891891891891892,4.891891891891892, rmse=46.567567567567565,r2=-1.0579651079506824, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.047297297297297,5.047297297297297, rmse=49.66891891891892,r2=-0.783544702225603, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5234899328859061, mae=5.02013422818792,5.02013422818792, rmse=49.81208053691275,r2=-0.8948986305876547, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5067567567567568, mae=5.121621621621622,5.121621621621622, rmse=49.75675675675676,r2=-1.0139142710899143, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.094594594594595,5.094594594594595, rmse=53.054054054054056,r2=-0.9050160732698489, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.1891891891891895,5.1891891891891895, rmse=52.82432432432432,r2=-0.8203506144326784, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.087837837837838,5.087837837837838, rmse=51.195945945945944,r2=-0.8702900677803276, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.243243243243243,5.243243243243243, rmse=52.21621621621622,r2=-1.0477717440929868, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.128378378378378,5.128378378378378, rmse=51.0472972972973,r2=-0.7898258419772055, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.114864864864865,5.114864864864865, rmse=52.58783783783784,r2=-0.9060450216106382, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.148648648648648,5.148648648648648, rmse=51.82432432432432,r2=-0.8238812828674118, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.047297297297297,5.047297297297297, rmse=49.804054054054056,r2=-0.8632584323397392, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.0608108108108105,5.0608108108108105, rmse=50.682432432432435,r2=-0.9025150981292713, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.141891891891892,5.141891891891892, rmse=51.33108108108108,r2=-0.871070166212915, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.081081081081081,5.081081081081081, rmse=50.013513513513516,r2=-0.8670670663846598, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.027027027027027,5.027027027027027, rmse=50.67567567567568,r2=-0.9322796896515109, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.081081081081081,5.081081081081081, rmse=52.945945945945944,r2=-1.161369138473753, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.54188293  5.09688008 51.01265919 -0.89820218]
pred: acc=0.57, mae=1.945,1.945, rmse=8.445,r2=-14.581899534111352, acc_naive=0.5, mae_naive=1.75
pred: acc=0.675, mae=1.83,1.83, rmse=6.66,r2=-6.085106382978723, acc_naive=0.5, mae_naive=1.75
Traceback (most recent call last):
  File "stint-test-strategy.py", line 117, in <module>
    print(len(df12_low))
NameError: name 'df12_low' is not defined

If you suspect this is an IPython 7.13.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

====================================
============ 12 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
testcar: 12
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5374149659863946, mae=5.034013605442177,5.034013605442177, rmse=48.7891156462585,r2=-0.8674899831014657, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.527027027027027, mae=5.074324324324325,5.074324324324325, rmse=49.57432432432432,r2=-0.8090697054511529, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.135135135135135,5.135135135135135, rmse=51.0945945945946,r2=-0.9646420051293845, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.081081081081081,5.081081081081081, rmse=50.472972972972975,r2=-0.9092882566579683, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.101351351351352,5.101351351351352, rmse=52.11486486486486,r2=-0.7805486751062221, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.054054054054054,5.054054054054054, rmse=49.891891891891895,r2=-0.8247838058518944, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.114864864864865,5.114864864864865, rmse=50.317567567567565,r2=-0.9464742367086283, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.027027027027027,5.027027027027027, rmse=49.986486486486484,r2=-0.8496655950617202, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.094594594594595,5.094594594594595, rmse=51.36486486486486,r2=-0.8382389702818887, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.216216216216216,5.216216216216216, rmse=50.5,r2=-0.816261019626388, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.054054054054054,5.054054054054054, rmse=51.9054054054054,r2=-0.9679059229167497, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.581081081081081, mae=4.898648648648648,4.898648648648648, rmse=47.38513513513514,r2=-0.9296858732189073, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.0675675675675675,5.0675675675675675, rmse=50.432432432432435,r2=-0.9751574784143269, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.9324324324324325,4.9324324324324325, rmse=48.310810810810814,r2=-0.863910901465659, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.216216216216216,5.216216216216216, rmse=51.7972972972973,r2=-0.8905843046749373, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.135135135135135,5.135135135135135, rmse=52.432432432432435,r2=-0.8633659286083979, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.0,5.0, rmse=49.7027027027027,r2=-0.9971126206361407, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.243243243243243,5.243243243243243, rmse=52.810810810810814,r2=-0.8185802796175969, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.141891891891892,5.141891891891892, rmse=50.83108108108108,r2=-0.9029684423539706, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.898648648648648,4.898648648648648, rmse=48.87162162162162,r2=-0.9683369740296992, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.148648648648648,5.148648648648648, rmse=51.229729729729726,r2=-0.7245509718249901, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5878378378378378, mae=4.844594594594595,4.844594594594595, rmse=46.66891891891892,r2=-0.8651491044972193, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.087837837837838,5.087837837837838, rmse=52.317567567567565,r2=-0.9919000472786941, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.121621621621622,5.121621621621622, rmse=50.78378378378378,r2=-0.8851298563741896, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.29054054054054,5.29054054054054, rmse=52.6554054054054,r2=-0.9738703030551958, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.168918918918919,5.168918918918919, rmse=52.5472972972973,r2=-0.9238416794811797, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5167785234899329, mae=5.1610738255033555,5.1610738255033555, rmse=49.13422818791946,r2=-0.8394596435846589, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5472972972972973, mae=5.29054054054054,5.29054054054054, rmse=53.92567567567568,r2=-0.9608034528552458, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.135135135135135,5.135135135135135, rmse=52.7972972972973,r2=-0.7935498879488829, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5167785234899329, mae=5.25503355704698,5.25503355704698, rmse=53.09395973154363,r2=-0.801934412797026, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5337837837837838, mae=5.141891891891892,5.141891891891892, rmse=51.20945945945946,r2=-0.9279683740116875, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.905405405405405,4.905405405405405, rmse=48.445945945945944,r2=-0.8835097933066498, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=4.9391891891891895,4.9391891891891895, rmse=47.62837837837838,r2=-0.8959255624613818, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.148648648648648,5.148648648648648, rmse=53.486486486486484,r2=-1.0107542937367309, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.263513513513513,5.263513513513513, rmse=52.439189189189186,r2=-0.9632787288738169, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.033783783783784,5.033783783783784, rmse=49.25,r2=-0.7905880478299263, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.168918918918919,5.168918918918919, rmse=51.4527027027027,r2=-0.9343599390352741, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.331081081081081,5.331081081081081, rmse=52.3445945945946,r2=-0.8465795254691517, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.155405405405405,5.155405405405405, rmse=52.62837837837838,r2=-0.9222606120434353, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.087837837837838,5.087837837837838, rmse=50.12837837837838,r2=-0.909612655480424, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.283783783783784,5.283783783783784, rmse=53.148648648648646,r2=-0.8261945808750979, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=4.905405405405405,4.905405405405405, rmse=49.270270270270274,r2=-0.7968635273080245, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.033783783783784,5.033783783783784, rmse=49.858108108108105,r2=-0.7993053816446771, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.972972972972973,4.972972972972973, rmse=50.78378378378378,r2=-0.939886888993912, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.101351351351352,5.101351351351352, rmse=50.817567567567565,r2=-0.7634120375651117, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=4.97972972972973,4.97972972972973, rmse=48.83108108108108,r2=-0.9620862470007265, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.094594594594595,5.094594594594595, rmse=51.54054054054054,r2=-0.8891203692083209, acc_naive=0.13513513513513514, mae_naive=4.614864864864865/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU

pred: acc=0.5405405405405406, mae=5.101351351351352,5.101351351351352, rmse=50.804054054054056,r2=-0.9074597188892699, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.087837837837838,5.087837837837838, rmse=50.263513513513516,r2=-0.9905334259018195, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.047297297297297,5.047297297297297, rmse=50.9527027027027,r2=-1.0170098025041208, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53777079  5.09616458 50.78048121 -0.8904194 ]
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5374149659863946, mae=5.319727891156463,5.319727891156463, rmse=53.95918367346939,r2=-0.9723066097417403, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5135135135135135, mae=5.128378378378378,5.128378378378378, rmse=50.07432432432432,r2=-0.9395034658367525, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.9324324324324325,4.9324324324324325, rmse=48.04054054054054,r2=-0.8836898323926341, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.1824324324324325,5.1824324324324325, rmse=51.020270270270274,r2=-0.8463322759714511, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.243243243243243,5.243243243243243, rmse=52.445945945945944,r2=-0.850515555254862, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.135135135135135,5.135135135135135, rmse=51.810810810810814,r2=-1.0197226864285067, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.148648648648648,5.148648648648648, rmse=52.013513513513516,r2=-1.0156859553553574, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=4.952702702702703,4.952702702702703, rmse=47.939189189189186,r2=-0.9818585373587301, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.25,5.25, rmse=53.439189189189186,r2=-0.9973449092559599, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.121621621621622,5.121621621621622, rmse=51.87837837837838,r2=-0.9399381661183788, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=4.972972972972973,4.972972972972973, rmse=48.567567567567565,r2=-0.8241308653194901, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.1891891891891895,5.1891891891891895, rmse=53.108108108108105,r2=-0.9297590787162144, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.155405405405405,5.155405405405405, rmse=52.358108108108105,r2=-0.8687745644394913, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.20945945945946,5.20945945945946, rmse=52.317567567567565,r2=-0.8290123023295901, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.148648648648648,5.148648648648648, rmse=50.74324324324324,r2=-0.8985540666342122, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.986486486486487,4.986486486486487, rmse=46.16216216216216,r2=-0.8076820623754144, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.972972972972973,4.972972972972973, rmse=48.54054054054054,r2=-0.7840570639452449, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.0,5.0, rmse=50.351351351351354,r2=-0.8649310857357366, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.222972972972973,5.222972972972973, rmse=51.33108108108108,r2=-0.9623227662084708, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.108108108108108,5.108108108108108, rmse=52.351351351351354,r2=-0.9270166216577291, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.851351351351352,4.851351351351352, rmse=47.391891891891895,r2=-0.9567545762826881, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.0675675675675675,5.0675675675675675, rmse=49.2972972972973,r2=-1.0360098424640096, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.02027027027027,5.02027027027027, rmse=50.83108108108108,r2=-0.7917439106030177, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.155405405405405,5.155405405405405, rmse=51.317567567567565,r2=-0.9555535452084536, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.108108108108108,5.108108108108108, rmse=50.986486486486484,r2=-0.8254611430299366, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.006756756756757,5.006756756756757, rmse=51.37162162162162,r2=-0.995155925303375, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.20945945945946,5.20945945945946, rmse=52.358108108108105,r2=-1.0131229725744615, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.966216216216216,4.966216216216216, rmse=48.62837837837838,r2=-0.7850061334888487, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.108108108108108,5.108108108108108, rmse=50.851351351351354,r2=-0.8718026709597404, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.891891891891892,4.891891891891892, rmse=49.21621621621622,r2=-0.8931075720299024, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.033783783783784,5.033783783783784, rmse=50.777027027027025,r2=-0.828358945021995, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.0608108108108105,5.0608108108108105, rmse=50.277027027027025,r2=-0.9137842346725984, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.222972972972973,5.222972972972973, rmse=53.29054054054054,r2=-0.871930567315834, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.054054054054054,5.054054054054054, rmse=51.36486486486486,r2=-0.9248368305347172, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.222972972972973,5.222972972972973, rmse=52.50675675675676,r2=-1.1032969283775778, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.202702702702703,5.202702702702703, rmse=52.63513513513514,r2=-0.8149732300421739, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.777027027027027,4.777027027027027, rmse=46.37162162162162,r2=-0.8101854162062747, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5167785234899329, mae=4.97986577181208,4.97986577181208, rmse=47.89261744966443,r2=-0.9792776592615757, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5540540540540541, mae=5.094594594594595,5.094594594594595, rmse=49.689189189189186,r2=-0.9003811615737451, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.263513513513513,5.263513513513513, rmse=52.4527027027027,r2=-0.8818530845432151, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.027027027027027,5.027027027027027, rmse=51.54054054054054,r2=-0.8651506815820038, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.972972972972973,4.972972972972973, rmse=49.2027027027027,r2=-0.8346972093173697, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.243243243243243,5.243243243243243, rmse=52.527027027027025,r2=-0.8036359532032102, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.22972972972973,5.22972972972973, rmse=52.432432432432435,r2=-1.1289792770798464, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.581081081081081, mae=4.804054054054054,4.804054054054054, rmse=48.3445945945946,r2=-1.0041409905067602, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.398648648648648,5.398648648648648, rmse=55.41216216216216,r2=-0.8832397207137315, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.101351351351352,5.101351351351352, rmse=51.8445945945946,r2=-0.7230975589031452, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.202702702702703,5.202702702702703, rmse=51.95945945945946,r2=-0.8746613035263961, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.114864864864865,5.114864864864865, rmse=53.61486486486486,r2=-0.867094443773172, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.277027027027027,5.277027027027027, rmse=53.42567567567568,r2=-0.9704790834573755, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53594873  5.10099187 50.96527927 -0.90501822]
pred: acc=0.61, mae=1.885,1.885, rmse=8.205,r2=-17.041888846132707, acc_naive=0.5, mae_naive=1.75
pred: acc=0.635, mae=1.95,1.95, rmse=7.52,r2=-6.520752075207521, acc_naive=0.5, mae_naive=1.75
Traceback (most recent call last):
  File "stint-test-strategy.py", line 117, in <module>
    print(len(df12_low))
NameError: name 'df12_low' is not defined

If you suspect this is an IPython 7.13.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

====================================
============ 20 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
testcar: 20
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5238095238095238, mae=5.197278911564626,5.197278911564626, rmse=50.36734693877551,r2=-0.8450318866523592, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5135135135135135, mae=5.1891891891891895,5.1891891891891895, rmse=52.932432432432435,r2=-1.1045264038713216, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.101351351351352,5.101351351351352, rmse=53.060810810810814,r2=-0.9299069455422202, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.047297297297297,5.047297297297297, rmse=50.16891891891892,r2=-0.8703662098404852, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.168918918918919,5.168918918918919, rmse=54.317567567567565,r2=-1.153667366591847, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.25,5.25, rmse=53.060810810810814,r2=-0.9633030622449261, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=4.905405405405405,4.905405405405405, rmse=47.986486486486484,r2=-0.863582609805698, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=5.0608108108108105,5.0608108108108105, rmse=51.520270270270274,r2=-0.8585432051594541, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.074324324324325,5.074324324324325, rmse=50.87162162162162,r2=-1.0098191997460426, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.094594594594595,5.094594594594595, rmse=50.24324324324324,r2=-0.9066567568082635, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.128378378378378,5.128378378378378, rmse=50.37162162162162,r2=-1.009961088360027, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.148648648648648,5.148648648648648, rmse=51.310810810810814,r2=-0.8464652372417167, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.79054054054054,4.79054054054054, rmse=46.91216216216216,r2=-0.9940308934254445, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.054054054054054,5.054054054054054, rmse=52.4054054054054,r2=-0.7695451301158791, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.114864864864865,5.114864864864865, rmse=49.777027027027025,r2=-0.901015440838018, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.3108108108108105,5.3108108108108105, rmse=54.74324324324324,r2=-0.8703757142032666, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.033783783783784,5.033783783783784, rmse=49.96621621621622,r2=-0.9168902682518443, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1891891891891895,5.1891891891891895, rmse=50.472972972972975,r2=-0.7768020584392312, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.121621621621622,5.121621621621622, rmse=52.28378378378378,r2=-1.0208967497278056, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.1824324324324325,5.1824324324324325, rmse=50.979729729729726,r2=-0.9357287975758752, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.236486486486487,5.236486486486487, rmse=52.70945945945946,r2=-0.8399054029934472, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.128378378378378,5.128378378378378, rmse=51.75,r2=-0.7930753022911485, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.905405405405405,4.905405405405405, rmse=46.08108108108108,r2=-0.6907797426710154, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.993243243243243,4.993243243243243, rmse=49.020270270270274,r2=-0.8005620992192322, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.175675675675675,5.175675675675675, rmse=50.013513513513516,r2=-0.7816564342346008, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5369127516778524, mae=5.208053691275167,5.208053691275167, rmse=51.97315436241611,r2=-0.7791758026564524, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5067567567567568, mae=5.331081081081081,5.331081081081081, rmse=54.25,r2=-0.985423753734286, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.27027027027027,5.27027027027027, rmse=53.32432432432432,r2=-0.8598655119098229, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=4.972972972972973,4.972972972972973, rmse=49.82432432432432,r2=-0.8779276155602627, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4899328859060403, mae=5.295302013422819,5.295302013422819, rmse=53.375838926174495,r2=-1.0063203483725909, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5202702702702703, mae=5.162162162162162,5.162162162162162, rmse=51.891891891891895,r2=-0.9554793990286601, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.135135135135135,5.135135135135135, rmse=50.945945945945944,r2=-0.7532597100001104, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4864864864864865, mae=5.175675675675675,5.175675675675675, rmse=52.351351351351354,r2=-0.9825895118666221, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1891891891891895,5.1891891891891895, rmse=53.36486486486486,r2=-1.0414434836976736, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.972972972972973,4.972972972972973, rmse=51.25675675675676,r2=-0.807880274194509, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.371621621621622,5.371621621621622, rmse=54.479729729729726,r2=-1.1151176558168556, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.108108108108108,5.108108108108108, rmse=51.148648648648646,r2=-0.9074925044309412, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.074324324324325,5.074324324324325, rmse=50.50675675675676,r2=-0.768257986970226, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5234899328859061, mae=5.174496644295302,5.174496644295302, rmse=50.24832214765101,r2=-0.9450211664934758, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5202702702702703, mae=5.128378378378378,5.128378378378378, rmse=49.33108108108108,r2=-0.8730507616676948, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.101351351351352,5.101351351351352, rmse=51.03378378378378,r2=-0.912492129971805, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4797297297297297, mae=5.29054054054054,5.29054054054054, rmse=54.479729729729726,r2=-0.9252999296560891, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.168918918918919,5.168918918918919, rmse=50.277027027027025,r2=-0.9860272529882346, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=4.79054054054054,4.79054054054054, rmse=45.0472972972973,r2=-0.7863898383639416, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.175675675675675,5.175675675675675, rmse=52.0,r2=-0.978753307309175, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.371621621621622,5.371621621621622, rmse=54.195945945945944,r2=-0.9262228049223737, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.074324324324325,5.074324324324325, rmse=49.979729729729726,r2=-0.9507412687099075, acc_naive=0.13513513513513514, mae_naive=4.614864864864865/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU

pred: acc=0.5337837837837838, mae=5.02027027027027,5.02027027027027, rmse=52.12837837837838,r2=-0.8783023523605855, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.101351351351352,5.101351351351352, rmse=48.8445945945946,r2=-0.9669012479134036, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.141891891891892,5.141891891891892, rmse=52.560810810810814,r2=-0.9140730987151864, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.52891533  5.1281783  51.2429419  -0.90673205]
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5306122448979592, mae=4.993197278911564,4.993197278911564, rmse=49.72789115646258,r2=-0.7429491795939815, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5, mae=5.074324324324325,5.074324324324325, rmse=50.88513513513514,r2=-0.8786753055872065, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=4.945945945945946,4.945945945945946, rmse=50.08108108108108,r2=-0.921327198496533, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.966216216216216,4.966216216216216, rmse=48.66891891891892,r2=-0.8516838163261056, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.243243243243243,5.243243243243243, rmse=53.391891891891895,r2=-0.9710684255499882, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.9324324324324325,4.9324324324324325, rmse=48.513513513513516,r2=-0.8091215382231915, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.9391891891891895,4.9391891891891895, rmse=48.479729729729726,r2=-0.7707423143880523, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.148648648648648,5.148648648648648, rmse=51.4054054054054,r2=-0.8669721956468752, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.95945945945946,4.95945945945946, rmse=49.567567567567565,r2=-0.9237841774293858, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.121621621621622,5.121621621621622, rmse=51.2972972972973,r2=-0.9888311269941572, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.0,5.0, rmse=49.0,r2=-0.8783783547283404, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.945945945945946,4.945945945945946, rmse=48.513513513513516,r2=-0.9649589955528437, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.0,5.0, rmse=50.527027027027025,r2=-0.9079062823768322, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.175675675675675,5.175675675675675, rmse=52.027027027027025,r2=-0.9358992435451621, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.1824324324324325,5.1824324324324325, rmse=51.29054054054054,r2=-0.7430106926318274, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.344594594594595,5.344594594594595, rmse=53.101351351351354,r2=-0.9842438551717549, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.108108108108108,5.108108108108108, rmse=50.810810810810814,r2=-0.9640459035024098, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.0675675675675675,5.0675675675675675, rmse=51.9054054054054,r2=-0.8622816773599646, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.128378378378378,5.128378378378378, rmse=50.79054054054054,r2=-0.9394922003026436, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.168918918918919,5.168918918918919, rmse=52.060810810810814,r2=-0.993475935081009, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4797297297297297, mae=5.1824324324324325,5.1824324324324325, rmse=52.560810810810814,r2=-0.9614621879663892, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.263513513513513,5.263513513513513, rmse=51.398648648648646,r2=-1.0629530545681094, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.148648648648648,5.148648648648648, rmse=51.16216216216216,r2=-0.9929327867832085, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.912162162162162,4.912162162162162, rmse=49.88513513513514,r2=-0.7477574888994103, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.128378378378378,5.128378378378378, rmse=50.38513513513514,r2=-1.059560332922778, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=4.97972972972973,4.97972972972973, rmse=48.29054054054054,r2=-1.14755349819304, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.148648648648648,5.148648648648648, rmse=50.972972972972975,r2=-1.0715930407096592, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.101351351351352,5.101351351351352, rmse=51.3445945945946,r2=-0.8525231760589826, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.094594594594595,5.094594594594595, rmse=51.7972972972973,r2=-0.7188887660042511, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5503355704697986, mae=4.899328859060403,4.899328859060403, rmse=48.20134228187919,r2=-0.8067955034325327, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5337837837837838, mae=5.101351351351352,5.101351351351352, rmse=51.304054054054056,r2=-1.0404174655743423, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.074324324324325,5.074324324324325, rmse=50.62837837837838,r2=-0.8146894800230404, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.256756756756757,5.256756756756757, rmse=51.45945945945946,r2=-0.9944122315155095, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.29054054054054,5.29054054054054, rmse=54.641891891891895,r2=-1.1028075477002002, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.168918918918919,5.168918918918919, rmse=51.520270270270274,r2=-0.7810247086600255, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.128378378378378,5.128378378378378, rmse=51.479729729729726,r2=-0.8785017458752036, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.047297297297297,5.047297297297297, rmse=51.317567567567565,r2=-0.8757342339936991, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.027027027027027,5.027027027027027, rmse=50.17567567567568,r2=-0.8657436250884873, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.344594594594595,5.344594594594595, rmse=55.263513513513516,r2=-0.9557122361669401, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.047297297297297,5.047297297297297, rmse=51.641891891891895,r2=-1.0545101856964343, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.074324324324325,5.074324324324325, rmse=48.804054054054056,r2=-1.007896318557476, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.202702702702703,5.202702702702703, rmse=51.810810810810814,r2=-0.9986087311804475, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.101351351351352,5.101351351351352, rmse=51.00675675675676,r2=-0.8977259601992076, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1891891891891895,5.1891891891891895, rmse=54.4054054054054,r2=-1.0206628176107029, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5945945945945946, mae=5.013513513513513,5.013513513513513, rmse=50.08108108108108,r2=-0.8672472224728205, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.02027027027027,5.02027027027027, rmse=52.38513513513514,r2=-0.9903763425938774, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.162162162162162,5.162162162162162, rmse=52.054054054054056,r2=-0.9078656084815446, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.141891891891892,5.141891891891892, rmse=51.07432432432432,r2=-0.829464209789569, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.047297297297297,5.047297297297297, rmse=51.1554054054054,r2=-0.8623484203808105, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.195945945945946,5.195945945945946, rmse=50.8445945945946,r2=-0.8776975991367684, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53418652  5.09879647 51.02196305 -0.9188863 ]
pred: acc=0.375, mae=1.53,1.53, rmse=3.36,r2=-0.9209879366531362, acc_naive=0.5, mae_naive=0.5
pred: acc=0.43, mae=1.23,1.23, rmse=2.3,r2=-0.5466343890794165, acc_naive=0.5, mae_naive=0.5
Traceback (most recent call last):
  File "stint-test-strategy.py", line 117, in <module>
    print(len(df12_low))
NameError: name 'df12_low' is not defined

If you suspect this is an IPython 7.13.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

====================================
============ 20 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
testcar: 20
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.54421768707483, mae=4.959183673469388,4.959183673469388, rmse=48.72789115646258,r2=-0.8124376037069423, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5135135135135135, mae=5.175675675675675,5.175675675675675, rmse=52.445945945945944,r2=-0.9433263580985183, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.972972972972973,4.972972972972973, rmse=50.13513513513514,r2=-0.9006048858159035, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.047297297297297,5.047297297297297, rmse=49.61486486486486,r2=-0.921259007304845, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.114864864864865,5.114864864864865, rmse=49.777027027027025,r2=-0.8170964215241856, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.114864864864865,5.114864864864865, rmse=50.736486486486484,r2=-0.8014783595396335, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.054054054054054,5.054054054054054, rmse=52.108108108108105,r2=-0.9760014819457117, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.013513513513513,5.013513513513513, rmse=48.13513513513514,r2=-0.9652450423952328, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.155405405405405,5.155405405405405, rmse=52.736486486486484,r2=-1.0538889363033772, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.175675675675675,5.175675675675675, rmse=51.83783783783784,r2=-0.7486120671998175, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.033783783783784,5.033783783783784, rmse=50.317567567567565,r2=-1.029289812271231, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.945945945945946,4.945945945945946, rmse=47.2972972972973,r2=-0.7521694936466943, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.114864864864865,5.114864864864865, rmse=51.641891891891895,r2=-0.8874249978308604, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.168918918918919,5.168918918918919, rmse=52.560810810810814,r2=-0.9122800023918198, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.04054054054054,5.04054054054054, rmse=50.527027027027025,r2=-0.8373372866527327, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.0,5.0, rmse=50.91891891891892,r2=-0.8653122182994355, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.243243243243243,5.243243243243243, rmse=54.28378378378378,r2=-0.9856283785250632, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.04054054054054,5.04054054054054, rmse=49.75675675675676,r2=-0.8969504246012889, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.074324324324325,5.074324324324325, rmse=51.58783783783784,r2=-0.8248087954110899, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.148648648648648,5.148648648648648, rmse=51.229729729729726,r2=-0.7775933162988082, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.297297297297297,5.297297297297297, rmse=53.62162162162162,r2=-0.9208614150744374, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.054054054054054,5.054054054054054, rmse=50.567567567567565,r2=-0.9002125582648108, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5234899328859061, mae=5.1610738255033555,5.1610738255033555, rmse=52.2751677852349,r2=-0.9930226407836351, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5, mae=5.222972972972973,5.222972972972973, rmse=51.939189189189186,r2=-0.918923477580321, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.094594594594595,5.094594594594595, rmse=50.66216216216216,r2=-0.8640117850405908, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.141891891891892,5.141891891891892, rmse=53.08783783783784,r2=-1.02201402220182, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.405405405405405,5.405405405405405, rmse=56.729729729729726,r2=-0.8909132964161752, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5302013422818792, mae=5.12751677852349,5.12751677852349, rmse=49.20805369127517,r2=-0.8606411352542638, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5067567567567568, mae=5.108108108108108,5.108108108108108, rmse=52.027027027027025,r2=-1.036239924668414, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.155405405405405,5.155405405405405, rmse=50.8445945945946,r2=-0.9723093924217416, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=4.97972972972973,4.97972972972973, rmse=48.398648648648646,r2=-0.9083178525654874, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.283783783783784,5.283783783783784, rmse=53.554054054054056,r2=-0.8761953658431263, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.114864864864865,5.114864864864865, rmse=49.439189189189186,r2=-0.7496752428408011, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.986486486486487,4.986486486486487, rmse=51.486486486486484,r2=-0.9353277629336751, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.29054054054054,5.29054054054054, rmse=52.560810810810814,r2=-0.8407477520113582, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.013513513513513,5.013513513513513, rmse=49.148648648648646,r2=-0.8876710263068837, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.114864864864865,5.114864864864865, rmse=51.25,r2=-1.012960930719629, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.074324324324325,5.074324324324325, rmse=50.79054054054054,r2=-0.935429772309748, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.081081081081081,5.081081081081081, rmse=50.945945945945944,r2=-0.7949522196432677, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5234899328859061, mae=5.093959731543624,5.093959731543624, rmse=50.18120805369127,r2=-0.7504100781819554, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5337837837837838, mae=5.155405405405405,5.155405405405405, rmse=52.641891891891895,r2=-0.8835932854594519, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.0675675675675675,5.0675675675675675, rmse=51.027027027027025,r2=-0.7977857736843885, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.27027027027027,5.27027027027027, rmse=53.28378378378378,r2=-0.8507421978443674, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.236486486486487,5.236486486486487, rmse=52.398648648648646,r2=-0.8647157451454417, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.878378378378378,4.878378378378378, rmse=47.486486486486484,r2=-1.0336483096661175, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1824324324324325,5.1824324324324325, rmse=52.979729729729726,r2=-0.7889132110374595, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.087837837837838,5.087837837837838, rmse=49.763513513513516,r2=-1.0270692463903952, acc_naive=0.13513513513513514, mae_naive=4.614864864864865/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU

pred: acc=0.527027027027027, mae=4.918918918918919,4.918918918918919, rmse=48.472972972972975,r2=-0.9394182943380236, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.101351351351352,5.101351351351352, rmse=49.817567567567565,r2=-0.839248392011974, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=4.972972972972973,4.972972972972973, rmse=49.067567567567565,r2=-0.9997655600231461, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.534455    5.10534819 51.04068425 -0.89608965]
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5578231292517006, mae=5.054421768707483,5.054421768707483, rmse=51.625850340136054,r2=-0.8792437764683287, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5135135135135135, mae=5.175675675675675,5.175675675675675, rmse=51.91891891891892,r2=-0.9148059907562529, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.236486486486487,5.236486486486487, rmse=52.804054054054056,r2=-0.8300949367088608, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.135135135135135,5.135135135135135, rmse=53.472972972972975,r2=-0.976166654575088, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=4.966216216216216,4.966216216216216, rmse=48.58783783783784,r2=-0.7673820768816881, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1824324324324325,5.1824324324324325, rmse=52.358108108108105,r2=-0.7858619959388584, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.114864864864865,5.114864864864865, rmse=52.87162162162162,r2=-0.8755506322553896, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.135135135135135,5.135135135135135, rmse=50.648648648648646,r2=-0.9434827927509699, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.074324324324325,5.074324324324325, rmse=51.53378378378378,r2=-0.8395204974936281, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.0608108108108105,5.0608108108108105, rmse=48.92567567567568,r2=-0.9861445738474199, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.918918918918919,4.918918918918919, rmse=47.986486486486484,r2=-0.783589421616623, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.1891891891891895,5.1891891891891895, rmse=50.95945945945946,r2=-0.7801267217718724, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.364864864864865,5.364864864864865, rmse=53.71621621621622,r2=-1.0280507374651604, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.054054054054054,5.054054054054054, rmse=48.71621621621622,r2=-0.8901258513342372, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.0675675675675675,5.0675675675675675, rmse=48.932432432432435,r2=-0.9316907538671986, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.952702702702703,4.952702702702703, rmse=48.5472972972973,r2=-0.8640876772266397, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.027027027027027,5.027027027027027, rmse=49.28378378378378,r2=-0.9589202921562399, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.0,5.0, rmse=50.24324324324324,r2=-0.8366284998105842, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.0,5.0, rmse=51.0,r2=-1.099744557995109, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.162162162162162,5.162162162162162, rmse=52.83783783783784,r2=-1.0757474940051615, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.047297297297297,5.047297297297297, rmse=50.101351351351354,r2=-0.8125512010781959, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.155405405405405,5.155405405405405, rmse=51.75,r2=-0.989699842022117, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.202702702702703,5.202702702702703, rmse=51.851351351351354,r2=-0.9525811159993605, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.094594594594595,5.094594594594595, rmse=51.689189189189186,r2=-0.9192075005381983, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5234899328859061, mae=5.053691275167785,5.053691275167785, rmse=49.281879194630875,r2=-1.0195269526952697, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5608108108108109, mae=4.95945945945946,4.95945945945946, rmse=50.87837837837838,r2=-0.7697080181855431, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.141891891891892,5.141891891891892, rmse=52.898648648648646,r2=-1.0029525040968585, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=4.878378378378378,4.878378378378378, rmse=47.75675675675676,r2=-0.8891194460848317, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.141891891891892,5.141891891891892, rmse=52.12837837837838,r2=-0.753840009830425, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5302013422818792, mae=5.087248322147651,5.087248322147651, rmse=49.006711409395976,r2=-0.86808994320172, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5067567567567568, mae=5.013513513513513,5.013513513513513, rmse=50.37837837837838,r2=-0.8211206078499651, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.195945945945946,5.195945945945946, rmse=53.46621621621622,r2=-0.8304074921539939, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.885135135135135,4.885135135135135, rmse=47.46621621621622,r2=-0.8415589752309698, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.121621621621622,5.121621621621622, rmse=50.71621621621622,r2=-0.6904710818127453, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.0675675675675675,5.0675675675675675, rmse=50.810810810810814,r2=-0.9359226577190081, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.581081081081081, mae=5.013513513513513,5.013513513513513, rmse=50.972972972972975,r2=-0.9185802143494168, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.013513513513513,5.013513513513513, rmse=50.810810810810814,r2=-0.9468949146256771, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.081081081081081,5.081081081081081, rmse=51.04054054054054,r2=-0.8146540040351185, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.087837837837838,5.087837837837838, rmse=49.0472972972973,r2=-0.8269709543568464, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.1891891891891895,5.1891891891891895, rmse=52.33783783783784,r2=-1.054277415112022, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5436241610738255, mae=5.067114093959732,5.067114093959732, rmse=50.8255033557047,r2=-0.8591795980373094, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5675675675675675, mae=4.966216216216216,4.966216216216216, rmse=50.16891891891892,r2=-0.7711966577910734, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.108108108108108,5.108108108108108, rmse=51.13513513513514,r2=-0.8913258956689423, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.128378378378378,5.128378378378378, rmse=48.91216216216216,r2=-0.783111756129711, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.162162162162162,5.162162162162162, rmse=50.66216216216216,r2=-1.0187484423293478, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.337837837837838,5.337837837837838, rmse=55.33783783783784,r2=-1.0996398746576728, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.952702702702703,4.952702702702703, rmse=48.804054054054056,r2=-0.7659329840025901, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.006756756756757,5.006756756756757, rmse=50.79054054054054,r2=-0.7730581905344758, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.202702702702703,5.202702702702703, rmse=52.391891891891895,r2=-0.9251959851767599, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.9391891891891895,4.9391891891891895, rmse=49.46621621621622,r2=-0.9161261114687305, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53485953  5.08349275 50.79709618 -0.89017233]
pred: acc=0.4, mae=1.465,1.465, rmse=3.195,r2=-0.8919038948350135, acc_naive=0.5, mae_naive=0.5
pred: acc=0.39, mae=1.25,1.25, rmse=2.34,r2=-0.7896749521988529, acc_naive=0.5, mae_naive=0.5
Traceback (most recent call last):
  File "stint-test-strategy.py", line 117, in <module>
    print(len(df12_low))
NameError: name 'df12_low' is not defined

If you suspect this is an IPython 7.13.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

====================================
============ 20 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
testcar: 20
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5374149659863946, mae=5.034013605442177,5.034013605442177, rmse=50.7891156462585,r2=-0.8165450121654501, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.5202702702702703, mae=5.074324324324325,5.074324324324325, rmse=50.83108108108108,r2=-1.0331392843316998, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.162162162162162,5.162162162162162, rmse=52.08108108108108,r2=-0.9105185502765838, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.108108108108108,5.108108108108108, rmse=48.189189189189186,r2=-0.8606605780807379, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=4.97972972972973,4.97972972972973, rmse=50.817567567567565,r2=-0.9133851770869859, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.0608108108108105,5.0608108108108105, rmse=49.6554054054054,r2=-0.857557623205039, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.966216216216216,4.966216216216216, rmse=49.08783783783784,r2=-0.8767367171681915, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.006756756756757,5.006756756756757, rmse=49.141891891891895,r2=-0.8998940977125103, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.101351351351352,5.101351351351352, rmse=51.03378378378378,r2=-0.9237218715366453, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.101351351351352,5.101351351351352, rmse=50.263513513513516,r2=-0.7746163765312704, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.175675675675675,5.175675675675675, rmse=50.770270270270274,r2=-0.9523084728564177, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.222972972972973,5.222972972972973, rmse=54.49324324324324,r2=-0.9765847519374711, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.162162162162162,5.162162162162162, rmse=51.891891891891895,r2=-0.7815813603554884, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5675675675675675, mae=5.074324324324325,5.074324324324325, rmse=50.91216216216216,r2=-1.0234647738077092, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5878378378378378, mae=4.972972972972973,4.972972972972973, rmse=50.189189189189186,r2=-0.9156773259309212, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.22972972972973,5.22972972972973, rmse=53.4054054054054,r2=-0.9658156140400997, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4864864864864865, mae=5.141891891891892,5.141891891891892, rmse=51.50675675675676,r2=-1.0161188866173925, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=4.912162162162162,4.912162162162162, rmse=48.898648648648646,r2=-0.9601985315110209, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.047297297297297,5.047297297297297, rmse=50.358108108108105,r2=-0.8438398480856923, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=4.986486486486487,4.986486486486487, rmse=50.472972972972975,r2=-1.0080535742503582, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.033783783783784,5.033783783783784, rmse=51.00675675675676,r2=-0.9121204860516858, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.02027027027027,5.02027027027027, rmse=48.520270270270274,r2=-0.8498711968251755, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.054054054054054,5.054054054054054, rmse=49.82432432432432,r2=-0.9983630061359805, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.121621621621622,5.121621621621622, rmse=51.729729729729726,r2=-0.8390374774195746, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.0608108108108105,5.0608108108108105, rmse=51.695945945945944,r2=-0.8884678758930775, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.047297297297297,5.047297297297297, rmse=49.236486486486484,r2=-0.93701551083747, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.0675675675675675,5.0675675675675675, rmse=51.054054054054056,r2=-0.9481995989623893, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.02027027027027,5.02027027027027, rmse=49.4527027027027,r2=-0.93589734424706, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.094594594594595,5.094594594594595, rmse=51.08108108108108,r2=-0.8729316448915707, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.094594594594595,5.094594594594595, rmse=49.891891891891895,r2=-0.879904975375136, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.331081081081081,5.331081081081081, rmse=53.182432432432435,r2=-0.9748755645369103, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1824324324324325,5.1824324324324325, rmse=50.46621621621622,r2=-1.0774672239595864, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.9324324324324325,4.9324324324324325, rmse=48.391891891891895,r2=-0.6771055666925623, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.128378378378378,5.128378378378378, rmse=50.141891891891895,r2=-0.8893086175102527, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=4.918918918918919,4.918918918918919, rmse=49.2972972972973,r2=-0.9064575075698054, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=4.925675675675675,4.925675675675675, rmse=49.00675675675676,r2=-0.8077412748987882, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.148648648648648,5.148648648648648, rmse=50.932432432432435,r2=-0.8125285333879222, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.1824324324324325,5.1824324324324325, rmse=51.263513513513516,r2=-0.9768247596915605, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.25,5.25, rmse=53.61486486486486,r2=-1.1040505095386206, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.9324324324324325,4.9324324324324325, rmse=48.54054054054054,r2=-0.8907851892951204, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.128378378378378,5.128378378378378, rmse=52.398648648648646,r2=-0.8821951235511358, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.324324324324325,5.324324324324325, rmse=54.74324324324324,r2=-1.054333542919113, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.094594594594595,5.094594594594595, rmse=52.054054054054056,r2=-0.7888086501004861, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.121621621621622,5.121621621621622, rmse=51.270270270270274,r2=-0.8638938449665152, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.918918918918919,4.918918918918919, rmse=50.36486486486486,r2=-0.9792493079215396, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4864864864864865, mae=5.162162162162162,5.162162162162162, rmse=49.91891891891892,r2=-0.8399540947082709, acc_naive=0.13513513513513514, mae_naive=4.614864864864865/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU

pred: acc=0.5135135135135135, mae=5.094594594594595,5.094594594594595, rmse=50.2027027027027,r2=-0.847578627606149, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.141891891891892,5.141891891891892, rmse=52.33108108108108,r2=-1.0159338726697151, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.97972972972973,4.97972972972973, rmse=47.79054054054054,r2=-0.82657704817343, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.4864864864864865, mae=5.148648648648648,5.148648648648648, rmse=52.45945945945946,r2=-1.023687459383492, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.53480235  5.08365325 50.73307961 -0.91223168]
init: load dataset with 7 races, 58 cars
predicting model=oracle, plen=2
loading model...done!, ctx:gpu(0)
pred: acc=0.5374149659863946, mae=5.068027210884353,5.068027210884353, rmse=50.95918367346939,r2=-0.8555701970194323, acc_naive=0.1360544217687075, mae_naive=4.625850340136054
pred: acc=0.527027027027027, mae=5.094594594594595,5.094594594594595, rmse=49.810810810810814,r2=-0.7011096403218691, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.094594594594595,5.094594594594595, rmse=50.0,r2=-0.8229665151411751, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.02027027027027,5.02027027027027, rmse=49.4527027027027,r2=-0.9058956836304517, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.033783783783784,5.033783783783784, rmse=49.722972972972975,r2=-0.818371844530519, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.27027027027027,5.27027027027027, rmse=52.7972972972973,r2=-0.974731701486421, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=4.918918918918919,4.918918918918919, rmse=47.7972972972973,r2=-0.7496937477751799, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.3108108108108105,5.3108108108108105, rmse=53.2972972972973,r2=-0.922650878218694, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5878378378378378, mae=5.121621621621622,5.121621621621622, rmse=51.74324324324324,r2=-0.907453377472075, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.114864864864865,5.114864864864865, rmse=51.53378378378378,r2=-0.9089943582319757, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.3108108108108105,5.3108108108108105, rmse=55.351351351351354,r2=-0.9816061519854207, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.1891891891891895,5.1891891891891895, rmse=53.82432432432432,r2=-1.2160261193679172, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5, mae=5.121621621621622,5.121621621621622, rmse=51.91891891891892,r2=-0.9537013972042172, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.148648648648648,5.148648648648648, rmse=51.33783783783784,r2=-0.9432930274997879, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.141891891891892,5.141891891891892, rmse=51.29054054054054,r2=-1.1221052790643204, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.074324324324325,5.074324324324325, rmse=51.263513513513516,r2=-0.8540688343339478, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.331081081081081,5.331081081081081, rmse=55.46621621621622,r2=-0.9523377942329692, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.101351351351352,5.101351351351352, rmse=50.57432432432432,r2=-0.7976554436936498, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.49324324324324326, mae=5.236486486486487,5.236486486486487, rmse=52.99324324324324,r2=-1.0182286052091665, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.20945945945946,5.20945945945946, rmse=53.20945945945946,r2=-0.8775977059638496, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5608108108108109, mae=5.006756756756757,5.006756756756757, rmse=50.979729729729726,r2=-0.9580632943354936, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.331081081081081,5.331081081081081, rmse=54.70945945945946,r2=-0.9680282208266549, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.1824324324324325,5.1824324324324325, rmse=52.49324324324324,r2=-0.930173374696158, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.195945945945946,5.195945945945946, rmse=53.939189189189186,r2=-0.91936448112288, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.175675675675675,5.175675675675675, rmse=51.91891891891892,r2=-0.9038301533969824, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.033783783783784,5.033783783783784, rmse=48.8445945945946,r2=-0.8652751820134452, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=4.891891891891892,4.891891891891892, rmse=47.986486486486484,r2=-0.9037352184205334, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=4.898648648648648,4.898648648648648, rmse=49.33108108108108,r2=-0.8311145154074535, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.972972972972973,4.972972972972973, rmse=49.86486486486486,r2=-0.7893048636446292, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.236486486486487,5.236486486486487, rmse=50.50675675675676,r2=-0.8709496299703705, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.047297297297297,5.047297297297297, rmse=51.777027027027025,r2=-0.8763094678746088, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=5.155405405405405,5.155405405405405, rmse=51.763513513513516,r2=-0.8840736728060672, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.141891891891892,5.141891891891892, rmse=51.75,r2=-0.9751385258755882, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.04054054054054,5.04054054054054, rmse=49.74324324324324,r2=-0.7291920261161995, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=5.074324324324325,5.074324324324325, rmse=49.41216216216216,r2=-0.9178988106207739, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.986486486486487,4.986486486486487, rmse=50.25675675675676,r2=-1.0235921286041232, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5405405405405406, mae=5.101351351351352,5.101351351351352, rmse=51.439189189189186,r2=-0.7585937792650495, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5337837837837838, mae=5.033783783783784,5.033783783783784, rmse=48.92567567567568,r2=-0.916979107040641, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5743243243243243, mae=5.135135135135135,5.135135135135135, rmse=53.13513513513514,r2=-0.9452235665351325, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5369127516778524, mae=5.040268456375839,5.040268456375839, rmse=50.369127516778526,r2=-0.9548712480114678, acc_naive=0.1342281879194631, mae_naive=4.590604026845638
pred: acc=0.5472972972972973, mae=5.141891891891892,5.141891891891892, rmse=50.736486486486484,r2=-1.007695976413458, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5472972972972973, mae=4.993243243243243,4.993243243243243, rmse=49.222972972972975,r2=-0.7240838935404024, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.20945945945946,5.20945945945946, rmse=53.03378378378378,r2=-0.9054095725486337, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5067567567567568, mae=5.148648648648648,5.148648648648648, rmse=50.189189189189186,r2=-0.8133957953598847, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5540540540540541, mae=4.993243243243243,4.993243243243243, rmse=50.00675675675676,r2=-0.9162707048935972, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5135135135135135, mae=5.0675675675675675,5.0675675675675675, rmse=52.82432432432432,r2=-0.8557591912737637, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.114864864864865,5.114864864864865, rmse=49.979729729729726,r2=-0.7421545786706387, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.27027027027027,5.27027027027027, rmse=52.62162162162162,r2=-1.0487633199726267, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.527027027027027, mae=5.1891891891891895,5.1891891891891895, rmse=54.148648648648646,r2=-1.0502860027208718, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
pred: acc=0.5202702702702703, mae=5.155405405405405,5.155405405405405, rmse=52.62837837837838,r2=-0.9805581708599351, acc_naive=0.13513513513513514, mae_naive=4.614864864864865
[ 0.5297298   5.11757132 51.3776473  -0.90500294]
pred: acc=0.41, mae=1.575,1.575, rmse=3.725,r2=-0.7617499261010936, acc_naive=0.5, mae_naive=0.5
pred: acc=0.37, mae=1.305,1.305, rmse=2.535,r2=-0.6990901322073093, acc_naive=0.5, mae_naive=0.5
Traceback (most recent call last):
  File "stint-test-strategy.py", line 117, in <module>
    dftestcar_high = df[df['carno']==testcar]
NameError: name 'df12_low' is not defined

If you suspect this is an IPython 7.13.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

====================================
============ 9 ========================
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
INFO:root:Using GPU
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:196: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['rank_diff'][mask] = 0
/N/u/pengb/hpda/indycar/predictor/src/indycar/model/stint_simulator.py:200: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  uni_ds['time_diff'][mask] = 0
INFO:root:Using GPU
